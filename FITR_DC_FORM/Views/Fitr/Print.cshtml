@using FITR_DC_FORM.Models
@model FITR_DC_FORM.Models.ViewModels.FitrViewModel
@{
    Layout = null;
    var printCompany = ViewBag.PrintCompany as PrintCompanyModel;
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>GearBox Test Certificate</title>
    

    <style>
        /* ================= PRINT PAGE ================= */
        @@page {
            size: A4;
            margin: 12mm;
        }

        /* ================= BASE ================= */
        html, body {
            margin: 0;
            padding: 0;
            font-family: Arial, Helvetica, sans-serif;
            font-size: 11px;
            background: #fff;
        }
        /* ======================================
           PROFESSIONAL CERTIFICATE HEADER STYLE
           ====================================== */

        /* Main Header Container */
        thead table {
            border-bottom: 2px solid #1f5fa9 !important; /* Blue bottom line */
            padding-bottom: 12px !important;
        }

        /* Company Name */
        thead h1 {
            font-size: 17px !important;
            font-weight: 700 !important;
            color: #000 !important;
            letter-spacing: 0.5px;
        }

        /* Address Text */
        thead div {
            font-size: 12px !important;
            color: #444 !important;
        }

        /* Certificate Title */
        thead h2 {
            font-size: 16px !important;
            font-weight: 700 !important;
            color: #1f5fa9 !important; /* Blue title */
            margin-top: 10px !important;
        }

        /* Logo */
        thead img {
            max-height: 75px !important;
        }

        /* TC Details Table */
        thead td table {
            border: 1px solid #d6dde5 !important;
        }

            thead td table td {
                border: 1px solid #d6dde5 !important;
                padding: 5px 8px !important;
                font-size: 12px !important;
            }

                /* TC Labels */
                thead td table td:first-child {
                    background: #f3f6f9 !important;
                    font-weight: 600 !important;
                }

        /* Improve spacing between 3 columns */
        thead > tr > td > table > tr > td {
            vertical-align: top !important;
        }

        /* Add subtle spacing */
        thead table tr td {
            padding: 4px 6px !important;
        }

        /* ================= MAIN TABLE ================= */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        /* ================= HEADER ================= */
        .header {
            width: 100%;
            display: table;
        }

            .header > div,
            .header img {
                display: table-cell;
                vertical-align: top;
            }

            .header img {
                max-height: 90px;
            }

        /* ================= HEADER INFO TABLE ================= */
        .header-info table {
            width: auto;
        }

        .header-info td {
            border: none;
            padding: 2px 4px;
            font-size: 11px;
        }

        /* ================= TABLE CELLS ================= */
        td, th {
            border: 1px solid #000;
            padding: 4px 6px;
            vertical-align: middle;
        }

        /* remove border helper */
        .no-border td {
            border: none !important;
        }

        /* ================= SECTION TITLES ================= */
        .section-title {
            font-weight: bold;
            padding: 4px 6px;
            margin-top: 6px;
            /* border: 1px solid #000; */
            background: #f2f2f2;
        }

        /* ================= TEXT HELPERS ================= */
        .bold {
            font-weight: bold;
        }

        .center {
            text-align: center;
        }

        /* ================= PAGE BREAK RULES ================= */
        /* Repeat header row on each page */
        thead {
            display: table-header-group;
        }

        /* Prevent row splitting */
        tr {
            page-break-inside: avoid;
        }

        /* Avoid breaking important blocks */
        .no-break {
            page-break-inside: avoid;
        }

        /* ================= SIGNATURE AREA ================= */
        img.company-logo {
            max-height: 80px;
           
        }

        /* ================= SIGNATURE AREA ================= */
        .signature-table {
            margin-top: 50px;
            width: 100%;
            border-collapse: collapse;
        }

            .signature-table td {
                border: none !important;
                text-align: center;
                vertical-align: bottom;
                padding: 10px;
                width: 33.33%;
            }

        .signature-img {
            height: 60px;
            max-width: 150px;
            display: block;
            margin: 0 auto 5px auto;
        }

        .signature-name {
            font-weight: bold;
            font-size: 13px;
            display: block;
        }

        .signature-date {
            font-size: 10px;
            color: #555;
            display: block;
        }

        .signature-label {
            font-size: 11px;
            margin-top: 5px;
            display: block;
            border-top: 1px solid #000;
            width: 80%;
            margin-left: 10%;
            padding-top: 3px;
        }

        /* ================= REMOVE EXTRA SPACE ================= */
        h1, h2, h3, p {
            margin: 2px 0;
        }











       /* this is class i right if it is not work perfeclty then i remove from here  */

        /* ================= HEADER LAYOUT FIX ================= */

        .print-header {
            width: 100%;
            border: 1px solid #bfc7d1;
            padding: 10px 15px;
        }

            .print-header td {
                vertical-align: middle;
            }

        /* ================= LOGO CONTAINER ================= */

        .logo-wrapper {
            width: 180px; /* Fixed logo area width */
            height: 80px; /* Fixed height */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Prevent overflow */
        }

            /* ================= LOGO IMAGE CONTROL ================= */

            .logo-wrapper img {
                max-width: 100%;
                max-height: 75px; /* Force max height */
                object-fit: contain; /* Maintain aspect ratio */
                display: block;
            }

        /* ================= COMPANY TITLE ================= */

        .company-name {
            font-size: 18px;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 4px;
        }

        .company-address {
            font-size: 11px;
            line-height: 1.4;
            color: #333;
        }

        .certificate-title {
            font-size: 16px;
            font-weight: 600;
            text-decoration: underline;
            margin-top: 6px;
            color: #0d47a1;
        }

        /* ================= TC BOX ================= */

        .tc-box {
            border: 1px solid #bfc7d1;
            font-size: 11px;
        }

            .tc-box td {
                padding: 4px 6px;
            }

        .tc-label {
            font-weight: 600;
            background: #f4f6f9;
        }

    </style>



</head>

<body>

    <table style="width:100%; border-collapse:collapse; ">
        <!-- ================= HEADER (REPEATS EVERY PAGE) ================= -->
        <thead>
            <tr>
                <td style="border: none !important; padding: 0;">
                    <table class="no-border" style="width: 100%; border-bottom: 1.5px solid #000; margin-bottom: 15px;">
                        <tr>
                            <!-- COLUMN 1: COMPANY INFO & TITLE -->
                            <td style="width: 45%; vertical-align: top; padding-bottom: 15px;">
                                <h1 style=" margin: 0 0 5px 0; color: #000;  text-transform: uppercase; ">
                                    @(printCompany?.CompanyName ?? "AIRA EURO AUTOMATION PVT. LTD.")
                                </h1>
                                <div style="font-size: 11.5px; line-height: 1.4; color: #333;">
                                    @if (printCompany != null)
                                    {
                                        @Html.Raw(printCompany.CompanyAddress?.Replace("\n", "<br/>"))
                                    }
                                    else
                                    {
                                        @:Shed No.2, Cair Estate Nr. Kashiram Textile Mill,<br />
                                        @:Narol, Ahmedabad, Gujarat-382405
                                    }
                                </div>
                                <div style="margin-top: 15px;">
                                    <h2 style="font-size: 17px; font-weight: bold; text-decoration: underline; margin: 0; color: #000;">
                                        GearBox Test Certificate
                                    </h2>
                                </div>
                            </td>

                            <!-- COLUMN 2: CENTER LOGO -->
                            <td style="width: 25%; text-align: center; vertical-align: top; padding-top: 5px;">
                                @if (printCompany != null && !string.IsNullOrEmpty(printCompany.CompanyLogo))
                                {
                                    <img src="~/uploads/@printCompany.CompanyLogo" style="max-height: 85px; max-width: 100%;" />
                                }
                                else
                                {
                                    <img src="~/assets/images/logo/airaindia-logo.webp" style="max-height: 85px; max-width: 100%; " />
                                }
                            </td>

                            <!-- COLUMN 3: TC DETAILS -->
                            <td style="width: 30%; vertical-align: top; padding-top: 5px;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <tr>
                                        <td style="padding: 4px 8px; font-weight: bold; background: #f9f9f9; border: 1px solid #000; width: 40%;">TC No.</td>
                                        <td style="padding: 4px 8px; ">GB/@Model.Master.TCYear/@Model.Master.TCNo</td>
                                    </tr>
                                    <tr>
                                        <td style="padding: 4px 8px; font-weight: bold; background: #f9f9f9; border: 1px solid #000;">Date</td>
                                        <td style="padding: 4px 8px; border: 1px solid #000;">@Model.Master.TCDate?.ToString("dd-MM-yyyy")</td>
                                    </tr>
                                    @* <tr>
                                        <td style="padding: 4px 8px; font-weight: bold; background: #f9f9f9; border: 1px solid #000;">Sheet</td>
                                        <td style="padding: 4px 8px; border: 1px solid #000;">1 of 1</td>
                                    </tr> *@
                                </table>
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </thead>

        <!-- ================= CONTENT ================= -->
        <tbody>
            <tr>
                <td>

                    <!-- ================= BASIC DETAILS ================= -->
                    <div class="section-title">BASIC  DETAILS</div>
                    <table>
                        <tr>
                            <td class="bold">Customer</td>
                            <td colspan="3">@Model.Master.CompanyName</td>
                        </tr>
                        <tr>
                            <td class="bold">PO No</td>
                            <td>@Model.Master.PONo</td>
                            <td class="bold">PO Date</td>
                            <td>@Model.Master.PODate?.ToString("dd-MM-yyyy")</td>

                        </tr>
                        <tr>
                            <td class="bold">DC No</td>
                            <td>@Model.Master.DCNo</td>
                            <td>DC Date</td>
                            <td>@Model.Master.DCDate?.ToString("dd-MM-yyyy")</td>


                        </tr>
                        <tr>
                            <td class="bold">Quantity</td>
                            <td colspan="3">@Model.Master.Quantity</td>

                        </tr>
                    </table>


                    <!-- ================= PRODUCT ================= -->
                    <div class="section-title">PRODUCT DETAILS</div>
                    <table>
                        <tr>
                            <td class="bold">Type</td>
                            <td>@Model.Master.ProductType</td>
                            <td class="bold">Torque</td>
                            <td>@Model.Master.Torque</td>
                            <td class="bold">Ratio</td>
                            <td>@Model.Master.Ratio</td>
                        </tr>
                        <tr>
                            <td class="bold">Model</td>
                            <td>@Model.Master.Model</td>
                            <td class="bold">Handwheel Dia</td>
                            <td colspan="3">@Model.Master.HandwheelDia</td>
                        </tr>
                    </table>

                    <!-- ================= MATERIAL ================= -->
                    <div class="section-title">MATERIAL SPECIFICATION</div>
                    <table>
                        <tr>
                            <th>Component</th>
                            <th>Material</th>
                            <th>Component</th>
                            <th>Material</th>
                        </tr>
                        @{
                            // var materials = Model.Materials?.Where(m => !string.IsNullOrWhiteSpace(m.Component)).ToList() ?? new();
                            var materials = Model.Master.Materials?
                            .Where(m => !string.IsNullOrWhiteSpace(m.Component))
                            .ToList() ?? new();
                            for (int i = 0; i < materials.Count; i += 2)
                            {
                                <tr>
                                    <td>@materials[i].Component</td>
                                    <td>@materials[i].Material</td>
                                    <td>@(i + 1 < materials.Count ? materials[i + 1].Component : "")</td>
                                    <td>@(i + 1 < materials.Count ? materials[i + 1].Material : "")</td>
                                </tr>
                            }
                        }
                    </table>
                    <div class="section-title">SR NO </div>
                    <table>
                        <thead>
                            <tr class="center">
                                <th>Sr No</th>
                                <th>Shaft Dia</th>
                                <th>Output Drive</th>
                                <th>Actuator PCD</th>
                                <th>Valve PCD</th>
                                <th>Square Dia</th>
                                <th>Square Position</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model?.Master?.SrData != null && Model.Master.SrData.Any())
                            {
                                foreach (var s in Model.Master.SrData)
                                {
                                    <tr class="center">
                                        <td>@s.SrNo</td>
                                        <td>@s.ShaftDia</td>
                                        <td>@s.OutputDrive</td>
                                        <td>@s.ActuatorPCD</td>
                                        <td>@s.ValvePCD</td>
                                        <td>@s.SquareDia</td>
                                        <td>@s.SquarePosition</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="7" class="center">No SR Data</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <!-- VISUAL -->
                    <!-- VISUAL -->
                    <div class="section-title">VISUAL INSPECTION</div>

                    @if (Model.Master.Visuals != null && Model.Master.Visuals.Any())
                    {
                        <table class="no-break" style="width:100%; border-collapse:collapse;">
                            <thead>
                                <tr>
                                    <th style="width:60%">Inspection Item</th>
                                    <th>Product Value</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var v in Model.Master.Visuals)
                                {
                                    <tr>
                                        <td>@v.VisualItemName</td>
                                        <td>@v.ProductValue</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    }
                    else
                    {
                        <p>No visual inspection data available</p>
                    }



                    <!-- REMARKS -->
                    <div class="section-title">REMARKS</div>
                    <table class="no-break">
                        <tr><td>@Model.Master.FinalRemarks</td></tr>
                    </table>

                    @* <!-- SIGN -->
                    <table class="no-break" style="margin-top:70px; border:none;">
                        <tr class="center">
                            <td style="border:none;">Quality Person<br />Name / Sign</td>
                            <td style="border:none;">Quality Control<br />Name / Sign</td>
                            <td style="border:none;">Quality Management<br />Name / Sign</td>
                        </tr>
                    </table> *@

                    <!-- SIGNATURES -->
                    <table class="signature-table">
                        <tr>
                            <!-- Prepared By -->
                            <td>
                                @if (!string.IsNullOrEmpty(Model.Master.CreatedBySignature))
                                {
                                    <img src="@Url.Content(Model.Master.CreatedBySignature)" class="signature-img" />
                                }
                                <span class="signature-name">@Model.Master.CreatedByName</span>
                                <span class="signature-date">@Model.Master.CreatedOn?.ToString("dd-MM-yyyy HH:mm")</span>
                                <span class="signature-label">Prepared By</span>
                            </td>

                            <!-- HOD Approval -->
                            <td>
                                @if (!string.IsNullOrEmpty(Model.Master.HodSignature))
                                {
                                    <img src="@Url.Content(Model.Master.HodSignature)" class="signature-img" />
                                }
                                <span class="signature-name">@Model.Master.HodApprovedByName</span>
                                <span class="signature-date">@Model.Master.HodApprovedOn?.ToString("dd-MM-yyyy HH:mm")</span>
                                <span class="signature-label">HOD Approved</span>
                            </td>

                            <!-- Admin Approval -->
                            <td>
                                @if (!string.IsNullOrEmpty(Model.Master.AdminSignature))
                                {
                                    <img src="@Url.Content(Model.Master.AdminSignature)" class="signature-img" />
                                }
                                <span class="signature-name">@Model.Master.AdminApprovedByName</span>
                                <span class="signature-date">@Model.Master.AdminApprovedOn?.ToString("dd-MM-yyyy HH:mm")</span>
                                <span class="signature-label">Final Approved</span>
                            </td>
                        </tr>
                    </table>



                    @*  <div class="footer">
                    <b>AIRA EURO AUTOMATION PVT. LTD.</b><br />
                    Shed No.2, Cair Estate Nr. Kashiram Textile Mill,<br />
                    Narol, Ahmedabad, Gujarat-382405
                </div> *@

                </td>
            </tr>
        </tbody>
    </table>

    <script>
        window.onload = function () {
            window.print();
        };
    </script>

</body>
</html>
